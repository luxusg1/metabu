<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Installation &mdash; Learning Meta-features for AutoML</title><link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="#" class="icon icon-home"> Metabu
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <!-- Local TOC -->
              <div class="local-toc"><ul>
<li><a class="reference internal" href="#">Installation</a></li>
<li><a class="reference internal" href="#usage">Usage</a></li>
<li><a class="reference internal" href="#experiments">Experiments</a></li>
<li><a class="reference internal" href="#api">API</a></li>
<li><a class="reference internal" href="#the-metabu-metabu-metabu-class">The <cite>metabu.metabu.Metabu</cite> class</a></li>
<li><a class="reference internal" href="#cite-metabu">Cite Metabu</a></li>
</ul>
</div>
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="#">Metabu</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="#" class="icon icon-home"></a> &raquo;</li>
      <li>Installation</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/index.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="toctree-wrapper compound">
</div>
<div class="section" id="installation">
<h1>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h1>
<p>Install with pip:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip install -r requirements.txt
python setup.py install
</pre></div>
</div>
<p>Use Singularity:</p>
<ul class="simple">
<li><p>build <em>local</em> container with definition file <cite>env/metabu.def</cite>.</p></li>
<li><p>fetch <em>remote</em> container from (coming soon).</p></li>
</ul>
</div>
<div class="section" id="usage">
<h1>Usage<a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h1>
<p>Simple to use:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">metabu</span> <span class="kn">import</span> <span class="n">Metabu</span>

<span class="n">basic_representations</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="n">target_representations</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="n">metabu</span> <span class="o">=</span> <span class="n">Metabu</span><span class="p">()</span>
<span class="n">metabu</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">basic_reprs</span><span class="o">=</span><span class="n">basic_representations</span><span class="p">,</span>
             <span class="n">target_reprs</span><span class="o">=</span><span class="n">target_representations</span><span class="p">,</span>
             <span class="n">column_id</span><span class="o">=</span><span class="s2">&quot;task_id&quot;</span><span class="p">)</span>
<span class="n">metabu</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">basic_reprs</span><span class="o">=</span><span class="n">basic_representations</span><span class="p">)</span>
<span class="n">metabu</span><span class="o">.</span><span class="n">get_importances</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="experiments">
<h1>Experiments<a class="headerlink" href="#experiments" title="Permalink to this headline">¶</a></h1>
<p>&gt; Script to reproduce experiments will be available under the <strong>experiments</strong> branch.</p>
</div>
<div class="section" id="api">
<h1>API<a class="headerlink" href="#api" title="Permalink to this headline">¶</a></h1>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>All next cited parameters are also attributes of Metabu class.</p>
</div>
</div>
<div class="section" id="the-metabu-metabu-metabu-class">
<h1>The <cite>metabu.metabu.Metabu</cite> class<a class="headerlink" href="#the-metabu-metabu-metabu-class" title="Permalink to this headline">¶</a></h1>
<dl class="py class">
<dt id="metabu.metabu.Metabu">
<em class="property">class </em><code class="sig-prename descclassname">metabu.metabu.</code><code class="sig-name descname">Metabu</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">alpha</span><span class="o">=</span><span class="default_value">0.5</span></em>, <em class="sig-param"><span class="n">lambda_reg</span><span class="o">=</span><span class="default_value">0.001</span></em>, <em class="sig-param"><span class="n">learning_rate</span><span class="o">=</span><span class="default_value">0.01</span></em>, <em class="sig-param"><span class="n">early_stopping_patience</span><span class="o">=</span><span class="default_value">10</span></em>, <em class="sig-param"><span class="n">early_stopping_criterion_ndcg</span><span class="o">=</span><span class="default_value">10</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">ncpus</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">device</span><span class="o">=</span><span class="default_value">'cpu'</span></em>, <em class="sig-param"><span class="n">seed</span><span class="o">=</span><span class="default_value">42</span></em><span class="sig-paren">)</span><a class="headerlink" href="#metabu.metabu.Metabu" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>alpha: float, default 0.5,</strong></dt><dd><p>the trade-off parameter in fused_gromov_wasserstein distance</p>
</dd>
<dt><strong>lambda_reg: float, default 1e-3,</strong></dt><dd><p>the regularization weight</p>
</dd>
<dt><strong>learning_rate: float, default 0.01,</strong></dt><dd><p>parameter of ADAM optimizer</p>
</dd>
<dt><strong>early_stopping_patience: int, default 10,</strong></dt><dd><p>the training is stopped when successively early_stopping_patience no improvement are observed</p>
</dd>
<dt><strong>early_stopping_criterion_ndcg: int, default 10,</strong></dt><dd><p>Only consider the highest early_stopping_criterion_ndcg scores in the ranking when computing ndcg. If None, use all outputs.</p>
</dd>
<dt><strong>verbose: bool default True,</strong></dt><dd><p>output print during the training phase if set to True</p>
</dd>
<dt><strong>ncpus: int, default 1,</strong></dt><dd><p>number of cpu used to train the Linear Model</p>
</dd>
<dt><strong>device: str, choice:[“cpu”, “gpu”] default “cpu”,</strong></dt><dd><p>used device</p>
</dd>
<dt><strong>seed: int, default 42</strong></dt><dd><p>variable for reproducibility</p>
</dd>
</dl>
</dd>
<dt class="field-even">Attributes</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>mds</strong><span class="classifier">sklearn.manifold._mds.MDS, default None</span></dt><dd><p>multi dimensional scaling</p>
</dd>
<dt><strong>intrinsic_dim</strong><span class="classifier">int, default None</span></dt><dd><p>the intrinsic dimension corresponding to the target representation</p>
</dd>
<dt><strong>model</strong><span class="classifier">torch.nn.Linear, default None</span></dt><dd><p>The linear mapping of basic representation to metabu representation</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#metabu.metabu.Metabu.get_importances" title="metabu.metabu.Metabu.get_importances"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_importances</span></code></a>()</p></td>
<td><p>Get the importance scores of each basic representation (each column of given the basic representation dataframe) according to the resulted metabu representation.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#metabu.metabu.Metabu.predict" title="metabu.metabu.Metabu.predict"><code class="xref py py-obj docutils literal notranslate"><span class="pre">predict</span></code></a>(basic_reprs)</p></td>
<td><p>predict the metabu representation corresponding to the given basic representation</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#metabu.metabu.Metabu.train" title="metabu.metabu.Metabu.train"><code class="xref py py-obj docutils literal notranslate"><span class="pre">train</span></code></a>(basic_reprs, target_reprs, column_id)</p></td>
<td><p>Train the Linear mapping of basic representation  to metabu representation</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#metabu.metabu.Metabu.train_predict" title="metabu.metabu.Metabu.train_predict"><code class="xref py py-obj docutils literal notranslate"><span class="pre">train_predict</span></code></a>(basic_reprs, target_reprs, …)</p></td>
<td><p>Train the Linear mapping of basic representation to metabu representation using all task in train_ids and predict the metabu representation corresponding to the  basic representation for both tasks in test_ids and train_ids</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="metabu.metabu.Metabu.get_importances">
<code class="sig-name descname">get_importances</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#metabu.metabu.Metabu.get_importances" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the importance scores of each basic representation (each column of given the basic representation dataframe)
according to the resulted metabu representation. More the scores of one basic representation is high more this
basic representation is important for the concerned algorithm.</p>
<dl class="field-list simple">
<dt class="field-odd">Return importance</dt>
<dd class="field-odd"><p>importance score and importance labels for each basic representation of task</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Tuple[numpy.ndarray, List[str]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="metabu.metabu.Metabu.predict">
<code class="sig-name descname">predict</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">basic_reprs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#metabu.metabu.Metabu.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>predict the metabu representation corresponding to the given basic representation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>basic_reprs</strong> (<em>pandas.core.frame.DataFrame</em>) – The basic representation</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>metabu representation: the metabu representation</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="metabu.metabu.Metabu.psi">
<em class="property">property </em><code class="sig-name descname">psi</code><a class="headerlink" href="#metabu.metabu.Metabu.psi" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the Linear mapping model weight as umpy array</p>
<dl class="field-list simple">
<dt class="field-odd">Return model_weight</dt>
<dd class="field-odd"><p>the weight of the Linear model</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="metabu.metabu.Metabu.train">
<code class="sig-name descname">train</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">basic_reprs</span></em>, <em class="sig-param"><span class="n">target_reprs</span></em>, <em class="sig-param"><span class="n">column_id</span></em><span class="sig-paren">)</span><a class="headerlink" href="#metabu.metabu.Metabu.train" title="Permalink to this definition">¶</a></dt>
<dd><p>Train the Linear mapping of basic representation  to metabu representation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>basic_reprs</strong> (<em>pandas.core.dataFrame</em>) – the basic representation</p></li>
<li><p><strong>target_reprs</strong> (<em>pandas.core.dataFrame</em>) – the target representation</p></li>
<li><p><strong>column_id</strong> (<em>str</em>) – name of column which content the id of each datasets or tasks in the target_reprs dataframe</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="metabu.metabu.Metabu.train_predict">
<code class="sig-name descname">train_predict</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">basic_reprs</span></em>, <em class="sig-param"><span class="n">target_reprs</span></em>, <em class="sig-param"><span class="n">column_id</span></em>, <em class="sig-param"><span class="n">test_ids</span></em>, <em class="sig-param"><span class="n">train_ids</span></em><span class="sig-paren">)</span><a class="headerlink" href="#metabu.metabu.Metabu.train_predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Train the Linear mapping of basic representation to metabu representation using all task in train_ids and
predict the metabu representation corresponding to the  basic representation for both tasks in test_ids and
train_ids</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>basic_reprs</strong> (<em>pandas.core.frame.DataFrame</em>) – the basic representation</p></li>
<li><p><strong>target_reprs</strong> (<em>pandas.core.frame.DataFrame</em>) – the target representation</p></li>
<li><p><strong>test_ids</strong> (<em>list</em>) – list of test tasks (not use on the training step)</p></li>
<li><p><strong>test_ids</strong> – list of test tasks (not use on the training step)</p></li>
<li><p><strong>train_ids</strong> (<em>list</em>) – list of train tasks (use on the training step)</p></li>
<li><p><strong>column_id</strong> (<em>str</em>) – name of column which content the id of each datasets or tasks in the target_reprs dataframe</p></li>
</ul>
</dd>
<dt class="field-even">Return metabu representation</dt>
<dd class="field-even"><p>metabu representation corresponding to the training and testing tasks</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Tuple[numpy.ndarray, numpy.ndarray]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="cite-metabu">
<h1>Cite Metabu<a class="headerlink" href="#cite-metabu" title="Permalink to this headline">¶</a></h1>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>@inproceedings<span class="o">{</span>rakotoarison2022learning,
 <span class="nv">title</span>       <span class="o">=</span> <span class="o">{</span>Learning meta-features <span class="k">for</span> Auto<span class="o">{</span>ML<span class="o">}}</span>,
 <span class="nv">author</span>      <span class="o">=</span> <span class="o">{</span>Herilalaina Rakotoarison and Louisot Milijaona and Andry RASOANAIVO and Michele Sebag and Marc Schoenauer<span class="o">}</span>,
 <span class="nv">booktitle</span>   <span class="o">=</span> <span class="o">{</span>International Conference on Learning Representations<span class="o">}</span>,
 <span class="nv">year</span>        <span class="o">=</span> <span class="o">{</span><span class="m">2022</span><span class="o">}</span>,
 <span class="nv">url</span>         <span class="o">=</span> <span class="o">{</span>https://openreview.net/forum?id<span class="o">=</span>DTkEfj0Ygb8<span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
</div>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Herilalaina Rakotoarison and Louisot Milijaona.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>